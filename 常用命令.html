<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>常用命令 |  听潮亭</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="听潮亭" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-学习笔记/Linux/Shell/常用命令"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  常用命令
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html" class="article-date">
  <time datetime="2022-09-30T15:58:18.000Z" itemprop="datePublished">2022-09-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a> / <a class="article-category-link" href="/categories/Linux/Shell/">Shell</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">4.1k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">17 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="找出当前正在使用的-shell-类别"><a href="#找出当前正在使用的-shell-类别" class="headerlink" title="找出当前正在使用的 shell 类别"></a>找出当前正在使用的 shell 类别</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -p $$</span><br></pre></td></tr></table></figure>



<p>样例结果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个例子当前的shell是 bash</span></span><br><span class="line">[root@zabbix ~]# ps -p $$</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">15719 pts/0    00:00:00 bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个例子当前的shell是 zsh</span></span><br><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ ps -p $$</span><br><span class="line">    PID TTY          TIME CMD</span><br><span class="line"> 159553 pts/1    00:00:04 zsh</span><br></pre></td></tr></table></figure>



<h1 id="查看当前shell版本"><a href="#查看当前shell版本" class="headerlink" title="查看当前shell版本"></a>查看当前shell版本</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用对应shell名 --version</span><br></pre></td></tr></table></figure>

<p>样例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zsh的版本</span></span><br><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ zsh --version</span><br><span class="line">zsh 5.9 (x86_64-debian-linux-gnu)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">bash的版本</span></span><br><span class="line">[root@zabbix ~]# bash --version</span><br><span class="line">GNU bash, version 4.2.46(2)-release (x86_64-redhat-linux-gnu)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="查看当前系统支持的-shell-类型"><a href="#查看当前系统支持的-shell-类型" class="headerlink" title="查看当前系统支持的 shell 类型"></a>查看当前系统支持的 shell 类型</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/shells</span><br></pre></td></tr></table></figure>



<h1 id="shebang的写法"><a href="#shebang的写法" class="headerlink" title="shebang的写法"></a>shebang的写法</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">虽然shell的shebang有多种写法，但是通过参考权威文档，</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">以后我的shell，统一使用下面的这中写法</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span></span><br></pre></td></tr></table></figure>



<h1 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h1><h2 id="时间戳与指定时间格式互转"><a href="#时间戳与指定时间格式互转" class="headerlink" title="时间戳与指定时间格式互转"></a>时间戳与指定时间格式互转</h2><ul>
<li><p>date +%s   可以得到UNIX的时间戳;</p>
</li>
<li><p>将日期时间与时间戳互转：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date -d &quot;2015-08-04 00:00:00&quot; +%s     # 输出：1438617600</span><br></pre></td></tr></table></figure>
</li>
<li><p>时间戳转换为指定时间格式：（具体时间格式写法，查看data的帮助）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date -d @1438617600  &quot;+%Y-%m-%d&quot;    # 输出：2015-08-04</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果需要得到指定日期的前后几天：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">seconds=`date -d &quot;2015-08-04 00:00:00&quot; +%s`       # 得到时间戳</span><br><span class="line">seconds_new=`expr $seconds + 86400`                   # 加上一天的秒数86400</span><br><span class="line">date_new=`date -d @$seconds_new &quot;+%Y-%m-%d&quot;`   # 获得指定日前加上一天的日前</span><br></pre></td></tr></table></figure>
</li>
<li><p>get today,yesterday</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">today=$(date +%Y%m%d)  # 指定yyyyMMdd格式的日期</span><br><span class="line"></span><br><span class="line">yesterday=$(date -d &quot;1 day ago&quot; +%Y%m%d)   # 生成昨天yyyyMMdd的日期</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="计算耗时"><a href="#计算耗时" class="headerlink" title="计算耗时"></a>计算耗时</h2><p>start_time&#x3D;<code>date +%s</code><br>end_time&#x3D;<code>date +%s</code><br>cost_time&#x3D;$(( ${end_time} - ${start_time} ))</p>
<h1 id="计算-–这里有问题，let不好，重新整理"><a href="#计算-–这里有问题，let不好，重新整理" class="headerlink" title="计算 –这里有问题，let不好，重新整理"></a>计算 –这里有问题，let不好，重新整理</h1><p>let a &#x3D; “1 + 2”</p>
<h1 id="SED"><a href="#SED" class="headerlink" title="SED"></a>SED</h1><ol>
<li><p>使用sed匹配某一行并替换这一行的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sed -i &quot;/&lt;要替换的内容&gt;/c&lt;新内容&gt;&quot; &lt;文件&gt;</span><br><span class="line"></span><br><span class="line">(注意/c&lt;新内容&gt;,这里有一个字母c)</span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">sed -i &quot;/BUILD_NUMBER=/cBUILD_NUMBER=$1&quot; file</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看文件中间一段，你可以使用sed命令，如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">取文件100~200行[100,200]的数据</span><br><span class="line">sed -n &#x27;100,200p&#x27; filename &gt; xxx </span><br><span class="line"></span><br><span class="line">sed -n &#x27;3p&#x27; filename  # 输出文件的第3行</span><br><span class="line"></span><br><span class="line">sed -n &#x27;2,5p&#x27; filename  # 输出文件的第2到5行</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>删除文件中N行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;/xxx/d&#x27; filename  # 删除包含xxx的行</span><br><span class="line"></span><br><span class="line">sed &#x27;2d&#x27; filename  # 删除第2行</span><br><span class="line"></span><br><span class="line">sed &#x27;$d&#x27; filename  # 删除最后一行</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="MV"><a href="#MV" class="headerlink" title="MV"></a>MV</h1><p>批量mv文件到指定目录下</p>
<p>-t &lt;执行目录&gt;</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">例如：将查询出的sql文件批量mv到test_target目录下</span><br><span class="line">mv -t test_target `find . -name &quot;gen_sql_file_20200101_1595*.log&quot; -type f`</span><br></pre></td></tr></table></figure>



<h1 id="AWK"><a href="#AWK" class="headerlink" title="AWK"></a>AWK</h1><p>获取最后一列</p>
<p>样例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat xxx | awk -F &#x27;-&#x27; &#x27;&#123;print $NF&#125;&#x27;</span><br><span class="line"></span><br><span class="line">上面样例是对传过来的数据，按照 &#x27;-&#x27; 分割，打印最后一列。</span><br></pre></td></tr></table></figure>





<h1 id="Find"><a href="#Find" class="headerlink" title="Find"></a>Find</h1><p>使用find命令查找指定路径下的文件时：<br>注意：<br>  find &lt;非软连接路径&gt; …  –没有问题，非软连接路径可以直接使用路径名，或者最后带有”&#x2F;“路径符号，都可以匹配到<br>  find &lt;软连接路径&gt;&#x2F;  …  –软连接路径需要添加“&#x2F;” 路径符号，否则无法匹配到内容</p>
<h1 id="修改linux日期时间"><a href="#修改linux日期时间" class="headerlink" title="修改linux日期时间"></a>修改linux日期时间</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">date -s &quot;20091112 18:30:50&quot; &amp;&amp;hwclock --systohc</span><br><span class="line"></span><br><span class="line">date -s                        //设置当前时间，只有root权限才能设置，其他只能查看</span><br><span class="line">date -s 20120523               //设置成20120523，这样会把具体时间设置成空00:00:00</span><br><span class="line">date -s 01:01:01               //设置具体时间，不会对日期做更改</span><br><span class="line">date -s &quot;01:01:01 2012-05-23&quot;  //这样可以设置全部时间</span><br><span class="line">date -s &quot;01:01:01 20120523&quot;    //这样可以设置全部时间</span><br><span class="line">date -s &quot;2012-05-23 01:01:01&quot;  //这样可以设置全部时间</span><br><span class="line">date -s &quot;20120523 01:01:01&quot;    //这样可以设置全部时间</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查硬件时间，这是BIOS时间</span></span><br><span class="line">hwclock --show </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果它与我们的系统时间不同，让它设置它，使其匹配。 使用下面提供的命令，BIOS将从上面设置的系统时间获取时间，并记住它。</span></span><br><span class="line">hwclock --systohc </span><br></pre></td></tr></table></figure>

<h1 id="文件的三个时间"><a href="#文件的三个时间" class="headerlink" title="文件的三个时间"></a>文件的三个时间</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">stat</span> 1234</span></span><br><span class="line">  File: 1234</span><br><span class="line">  Size: 7630            Blocks: 8          IO Block: 65536  regular file</span><br><span class="line">Device: b8239a14h/3089340948d   Inode: 2533274791067408  Links: 1</span><br><span class="line">Access: (0644/-rw-r--r--)  Uid: (197609/ spoonli)   Gid: (197121/ UNKNOWN)</span><br><span class="line">Access: 2020-12-03 23:11:06.615512900 +0800</span><br><span class="line">Modify: 2020-12-03 23:11:06.615512900 +0800</span><br><span class="line">Change: 2020-12-03 23:11:06.615064400 +0800</span><br></pre></td></tr></table></figure>
<ul>
<li>三个时间代表的含义：<ul>
<li>access time：表示我们最后一次访问（仅仅是访问，没有改动）文件的时间</li>
<li>modify time：表示我们最后一次修改文件的时间</li>
<li>change time：表示我们最后一次对文件属性改变的时间，包括权限，大小，属性等等。</li>
</ul>
</li>
</ul>
<p>有以下三种情况：</p>
<ol>
<li>当我们仅仅只是读取文件时，access time 改变，而modify，change time 不会改变</li>
<li>当修改文件时，access，modify，change time 都会跟着改变</li>
<li>当修改文件属性时，change time 改变，而access，modify time 不变</li>
</ol>
<p>通过ls命令查看文件的时间属性</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -lc filename 列出文件的 ctime （最后更改时间）</span><br><span class="line">ls -lu filename 列出文件的 atime（最后存取时间）</span><br><span class="line">ls -l filename 列出文件的 mtime （最后修改时间）</span><br></pre></td></tr></table></figure>

<h1 id="文件md5"><a href="#文件md5" class="headerlink" title="文件md5"></a>文件md5</h1><p>MD5只与文件内容有关，只要文件内容不一样，得出来的MD5值完全不一样。就是文件内容差一个字符不一样，得出的MD5值也完全不一样。</p>
<p>修改文件名是不会改变文件的md5值的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cp</span> metabase.db.trace.db 1234</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">md5sum</span> 1234</span></span><br><span class="line">ff92155dcaddac06332929dd1948c241 *1234</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">md5sum</span> metabase.db.trace.db</span></span><br><span class="line">ff92155dcaddac06332929dd1948c241 *metabase.db.trace.db</span><br></pre></td></tr></table></figure>


<h1 id="SCP"><a href="#SCP" class="headerlink" title="SCP"></a>SCP</h1><p>无需单独输入密码，远程传输文件<br>-i <identity_file></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">使用当前主机root用户的id_rsa密钥， 将192.168.10.25主机下的文件传输到当前目录下</span><br><span class="line"></span><br><span class="line">scp -i /root/.ssh/id_rsa root@192.168.10.25:/opt/lobster-import-2.7.3_ti528-dev.zip ./</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>指定端口号，使用 <code>-P</code> 大写的 P ，</p>
<p>语法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -P port file_name [user@]ip:dir_path</span><br></pre></td></tr></table></figure>

<ul>
<li>-P port ，port 为指定的端口号</li>
<li>user，远程主机的用户名</li>
<li>ip，远程主机 IP</li>
<li>dir_path，远程的一个 user 可以写入文件的目录</li>
</ul>
<p>例如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -P 2233 test.log root@172.17.216.53:/home/test/</span><br></pre></td></tr></table></figure>





<h1 id="rsync替换cp命令显示速度和进度"><a href="#rsync替换cp命令显示速度和进度" class="headerlink" title="rsync替换cp命令显示速度和进度"></a>rsync替换cp命令显示速度和进度</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">rsync &quot;远程同步&quot;（remote sync）的意思</span><br><span class="line"></span><br><span class="line">  - 本地两个目录之间同步文件</span><br><span class="line">  - 本地与远程机器同步文件</span><br><span class="line">  - x，不支持远程与远程的同步</span><br><span class="line"></span><br><span class="line">如果是本地目录间同步，可以代替`cp`与`mv`</span><br><span class="line"></span><br><span class="line">rsync 的最大特点是增量传输，即会检查发送方和接收方已有的文件，仅传输有变动的部分（默认规则是文件大小或修改时间有变动）。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">参数：</span><br><span class="line"></span><br><span class="line">一般最常用的选项组合：-avzPr 来进行传输,</span><br><span class="line"></span><br><span class="line">一般，-a参数可以替代-r，</span><br><span class="line">  - 不过不需要同步文件元信息，则只使用-r，否则即可使用-a</span><br><span class="line"></span><br><span class="line">-P :--progress 显示同步的过程及传输时的进度等信息</span><br><span class="line">  - 这个参数可以实现传输文件时打印传输进度的功能</span><br></pre></td></tr></table></figure>




<h1 id="创建FTP用户"><a href="#创建FTP用户" class="headerlink" title="创建FTP用户"></a>创建FTP用户</h1><p>创建ftp用户和目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useradd lzy_datarefine --home-dir /data/DJ/datarefine/120000</span><br><span class="line">usermod --home /data/DJ/datarefine/120000 -m lzy_datarefine</span><br><span class="line">echo 123456 | passwd lzy_datarefine --stdin</span><br><span class="line">su - lzy_datarefine</span><br><span class="line">mkdir datarefine</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@datarefine01 ~]# useradd lzy_datarefine --home-dir /data/DJ/datarefine/120000</span><br><span class="line">useradd: cannot create directory /data/DJ/datarefine/120000</span><br><span class="line">    - 原因： 因为主目录所在的父目录不存在，或者主目录已经存在</span><br><span class="line">    - 我的情况是主目录所在父目录不存在，先创建父目录，然后再执行就可以了</span><br></pre></td></tr></table></figure>
<h1 id="lftp命令，linux登录ftp"><a href="#lftp命令，linux登录ftp" class="headerlink" title="lftp命令，linux登录ftp"></a>lftp命令，linux登录ftp</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lftp 用户名:密码@ftp地址:传送端口 (默认21)</span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">lftp simba_dw:123456f@192.168.10.129</span><br></pre></td></tr></table></figure>

<h1 id="Linux内置命令"><a href="#Linux内置命令" class="headerlink" title="Linux内置命令"></a>Linux内置命令</h1><h2 id="EXEC"><a href="#EXEC" class="headerlink" title="EXEC"></a>EXEC</h2><h1 id="并行"><a href="#并行" class="headerlink" title="并行"></a>并行</h1><ol>
<li>添加&amp;让命令异步执行<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">command &amp;</span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">sleep 10 &amp;</span><br></pre></td></tr></table></figure>
执行这条命令后，并不会阻塞10秒，而是立即返回。</li>
</ol>
<p>当一个程序正在执行并且占用当前终端时我们同时按下 Ctrl + z ,这样就会把正在执行的前台程序放到后台挂起。</p>
<ol start="2">
<li><p>如果command2需要等到并行的command1执行之后再执行，就需要<code>wait</code>命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">command1 &amp;    # command1命令会被放到后台执行</span><br><span class="line">wait          # wait后面的命令command2会等待command1命令执行之后再执行</span><br><span class="line">command2</span><br></pre></td></tr></table></figure>
</li>
<li><p>为了避免并发进程数过多，导致机器卡死，需要限制并发的数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"> </span><br><span class="line">while read line</span><br><span class="line">do</span><br><span class="line">&#123;</span><br><span class="line">  joblist=($(jobs -p))</span><br><span class="line">  while (( $&#123;#joblist[*]&#125; &gt;= 20 ))</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">      sleep 1</span><br><span class="line">      joblist=($(jobs -p))</span><br><span class="line">  &#125;</span><br><span class="line">  done</span><br><span class="line">  sleep 10 &amp;</span><br><span class="line">&#125;</span><br><span class="line">done</span><br></pre></td></tr></table></figure></li>
</ol>
<p>第二种执行并发程序的写法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"># 并发运行的最佳实践</span><br><span class="line"></span><br><span class="line"># 总进程数</span><br><span class="line">Sp=15</span><br><span class="line"># 并发数,并发数过大可能造成系统崩溃</span><br><span class="line">Qp=5</span><br><span class="line"># 存放进程的队列</span><br><span class="line">Qarr=();</span><br><span class="line"># 运行进程数</span><br><span class="line">run=0</span><br><span class="line"># 将进程的添加到队列里的函数</span><br><span class="line">function push() &#123;</span><br><span class="line">    Qarr=($&#123;Qarr[@]&#125; $1)</span><br><span class="line">    run=$&#123;#Qarr[@]&#125;</span><br><span class="line">&#125;</span><br><span class="line"># 检测队列里的进程是否运行完毕</span><br><span class="line">function check() &#123;</span><br><span class="line">    oldQ=($&#123;Qarr[@]&#125;)</span><br><span class="line">    Qarr=()</span><br><span class="line">    for p in &quot;$&#123;oldQ[@]&#125;&quot;;do</span><br><span class="line">        if [[ -d &quot;/proc/$p&quot; ]];then</span><br><span class="line">            Qarr=($&#123;Qarr[@]&#125; $p)</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">    run=$&#123;#Qarr[@]&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># main</span><br><span class="line">for((i=0; i&lt;$Sp; i++));do</span><br><span class="line">    echo &quot;running $i &quot; </span><br><span class="line">    sleep 3 &amp;</span><br><span class="line">    push $!</span><br><span class="line">    while [[ $run -gt $Qp ]];do</span><br><span class="line">        check</span><br><span class="line">        sleep 0.1</span><br><span class="line">    done</span><br><span class="line">done</span><br><span class="line">echo -e &quot;time-consuming: $SECONDS   seconds&quot;    #显示脚本执行耗时</span><br></pre></td></tr></table></figure>


<hr>
<h1 id="字符串比较"><a href="#字符串比较" class="headerlink" title="字符串比较"></a>字符串比较</h1><ol>
<li><p>需要注意的是 <code>[</code> 与 <code>]</code> 与操作数之间一定要有一个空格，否则会报错。</p>
</li>
<li><p>在进行字符串比较时，最好使用双中括号 <code>[[ ]]</code>. 因为单中括号可能会导致一些错误，因此最好避开它们。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在string字符串比较时，更推荐使用 [[ $str1 == $str2 ]]，</span><br><span class="line">     尽管&quot;==&quot;与  [[ $str1 = $str2 ]] 效果一样，但是，&quot;=&quot;可能会与赋值语句混淆</span><br><span class="line"></span><br><span class="line">[[ -z $str1 ]]   如果 str1 是空字符串，则返回真</span><br><span class="line"></span><br><span class="line">[[ -n $str1 ]]   如果 str1 是非空字符串，则返回真</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>  &#x3D; 号 前后有一个空格，有空格是关系比较，没有空格就变成了赋值效果</p>
</li>
</ol>
<p>举例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Do this:</span></span><br><span class="line">if [[ &quot;$&#123;my_var&#125;&quot; == &quot;some_string&quot; ]]; then</span><br><span class="line">  do_something</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-z (string length is zero) and -n (string length is not zero) are</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">preferred over testing <span class="keyword">for</span> an empty string</span></span><br><span class="line">if [[ -z &quot;$&#123;my_var&#125;&quot; ]]; then</span><br><span class="line">  do_something</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This is OK (ensure quotes on the empty side), but not preferred:</span></span><br><span class="line">if [[ &quot;$&#123;my_var&#125;&quot; == &quot;&quot; ]]; then</span><br><span class="line">  do_something</span><br><span class="line">fi</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>注</strong>：当做string空值判断时，用上面的例子，不要用下面的例子<br>不好的例子：(不建议)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Not this: 这种使用填充字符的方式不好</span></span><br><span class="line">if [[ &quot;$&#123;my_var&#125;X&quot; == &quot;some_stringX&quot; ]]; then</span><br><span class="line">  do_something</span><br><span class="line">fi</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>可以通过 -a (and) 或 -o (or) 结合多个条件进行测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ $var1 -ne 0 -a $var2 -gt 2 ]  # 使用逻辑与 -a</span><br><span class="line">[ $var1 -ne 0 -o $var2 -gt 2 ]  # 使用逻辑或 -o</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用逻辑运算符 &amp;&amp; 和 || 可以轻松地将多个条件组合起来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if [[ -n $str1 ]] &amp;&amp; [[ -z $str2 ]];</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="数值比较"><a href="#数值比较" class="headerlink" title="数值比较"></a>数值比较</h1><p>结论：</p>
<ol>
<li>不要将<code>&gt;</code>和<code>&lt;</code>等比较符号，与<code>[[ ... ]]</code>搭配来做数值比较，因为可能变成字典比较</li>
<li>建议使用<code>(( ... ))</code>搭配<code>&gt;</code>和<code>&lt;</code>等比价符号 </li>
<li>或者 将<code>-lt</code>,<code>-gt</code>与<code>[[ ... ]]</code>搭配来做数值比较</li>
</ol>
<p>举例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if (( $my_var &gt; 3 )); then</span><br><span class="line">  do_something</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [[ &quot;$&#123;my_var&#125;&quot; -gt 3 ]]; then</span><br><span class="line">  do_something</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>错误例子：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Probably unintended lexicographical comparison.</span></span><br><span class="line">if [[ &quot;$&#123;my_var&#125;&quot; &gt; 3 ]]; then</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">True <span class="keyword">for</span> 4, <span class="literal">false</span> <span class="keyword">for</span> 22.</span></span><br><span class="line">  do_something</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h1 id="shell算术操作"><a href="#shell算术操作" class="headerlink" title="shell算术操作"></a>shell算术操作</h1><p><strong>注意：</strong> 埋坑点，let aa&#x3D;”0<em>3600”;echo $? &#x3D;1, ((aa&#x3D;0</em>3600));echo $?&#x3D;1, aa$((0*3600));echo $?&#x3D;0</p>
<blockquote>
<p>TODO(SLi): <strong>上面的shell算术部分写的有问题，需要修改一下</strong></p>
</blockquote>
<hr>
<h1 id="使用Trap捕获signals-信号量"><a href="#使用Trap捕获signals-信号量" class="headerlink" title="使用Trap捕获signals(信号量)"></a>使用Trap捕获signals(信号量)</h1><h4 id="1-主要参考："><a href="#1-主要参考：" class="headerlink" title="1. 主要参考："></a>1. 主要参考：</h4><p><a target="_blank" rel="noopener" href="https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_12_02.html">Catching signals</a>，<br>还有<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/22009364/is-there-a-try-catch-command-in-bash">Mark K Cowan’s answer</a></p>
<h4 id="2-主要目的："><a href="#2-主要目的：" class="headerlink" title="2.主要目的："></a>2.主要目的：</h4><p>在脚本退出前做一些操作，可以是异常处理，可以是清理工作等</p>
<h4 id="3-语法及用法："><a href="#3-语法及用法：" class="headerlink" title="3. 语法及用法："></a>3. 语法及用法：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">trap [COMMANDS] [SIGNALS]</span><br><span class="line"></span><br><span class="line">your_code_do_some_thing</span><br></pre></td></tr></table></figure>
<p>关于<code>SIGNALS</code>的知识点，参考<a target="_blank" rel="noopener" href="https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_12_01.html">Signals</a>章节。</p>
<ul>
<li>注意：SIGKILL and SIGSTOP can not be caught, blocked or ignored.<ul>
<li>可以理解为，就是当你执行kill -9 PID的时候，程序会直接被杀掉，不会其他机会了。</li>
</ul>
</li>
</ul>
<h4 id="4-样例："><a href="#4-样例：" class="headerlink" title="4. 样例："></a>4. 样例：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Here is a very simple example, catching Ctrl+C from the user, upon <span class="built_in">which</span> a message is printed. When you try to <span class="built_in">kill</span> this program without specifying the KILL signal, nothing will happen:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">主要测试，捕获用户输入的Ctrl+C的快捷键，并打印信息。如果你使用<span class="built_in">kill</span>命令来直接杀死这个脚本，那么什么都不会输出</span></span><br><span class="line"></span><br><span class="line">trap &quot;echo Booh!&quot; SIGINT SIGTERM</span><br><span class="line">echo &quot;pid is $$&quot;</span><br><span class="line"></span><br><span class="line">while :			# This is the same as &quot;while true&quot;.</span><br><span class="line">do</span><br><span class="line">        sleep 60	# This script is not really doing anything.</span><br><span class="line">done</span><br></pre></td></tr></table></figure>


<h1 id="新手可能常犯的错误"><a href="#新手可能常犯的错误" class="headerlink" title="新手可能常犯的错误"></a>新手可能常犯的错误</h1><h3 id="1-引用变量时，关于引号的使用"><a href="#1-引用变量时，关于引号的使用" class="headerlink" title="1. 引用变量时，关于引号的使用"></a>1. 引用变量时，关于引号的使用</h3><p>引用变量时需要在变量名前添加”$”前缀，但是是否使用引号，以及如何使用，可能会带来不同的结果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">定义变量如下：</span></span><br><span class="line"></span><br><span class="line">example=&quot;Hello world&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">主要注意，不使用引号，使用双引号的区别</span><br><span class="line"></span><br><span class="line">使用方式        结果            单词数</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">example        Hello world    2</span></span><br><span class="line">&quot;$example&quot;      Hello world    1</span><br></pre></td></tr></table></figure>
<p>在下面两个地方使用内容中有空格的变量时尤其需要注意：</p>
<ul>
<li>在脚本中引用外部配置文件的时候尤其需要注意上面的内容，</li>
<li>在for循环中使用时需要注意<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for animal in &quot;$example&quot;; do</span><br><span class="line">    ... # 这里就只会循环一次</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">for animal in $example; do</span><br><span class="line">    ... # 这里就会循环两次</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
上面的内容引用<a target="_blank" rel="noopener" href="https://wiki.bash-hackers.org/scripting/newbie_traps#expanding_using_variables">Expanding (using) variables</a> 和 <a target="_blank" rel="noopener" href="https://wiki.bash-hackers.org/syntax/quoting#string_lists_in_for-loops">String lists in for-loops</a> 两个章节</li>
</ul>
<h3 id="总的规则就是"><a href="#总的规则就是" class="headerlink" title="总的规则就是"></a>总的规则就是</h3><ol>
<li>引用变量时，总是用双引号(“”)将应用的变量包起来，而不是裸用<code>$</code>符号<ul>
<li>数组除外，只有在使用<em>数组</em> 时，不需要用双引号包起来</li>
<li>如果是<code>$数字</code>的形式，那么当超过9的时候，需要使用例如，<code>$&#123;11&#125;</code>的形式，否则<code>$11</code>则是$1和数字1的组合，并不是第11个参数<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line"></span><br><span class="line">PRG=&quot;$0&quot;</span><br><span class="line"></span><br><span class="line">PRGDIR=`dirname &quot;$PRG&quot;`</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h1 id="后台运行"><a href="#后台运行" class="headerlink" title="后台运行"></a>后台运行</h1><h2 id="screen-命令"><a href="#screen-命令" class="headerlink" title="screen 命令"></a>screen 命令</h2><ol>
<li>开启一个新的session</li>
<li>查看开启的session</li>
<li>临时离开当前session</li>
<li>进入指定session</li>
<li>关闭（销毁）session</li>
<li>新session自定义名称</li>
</ol>
<ul>
<li>screen -S &lt;新session名称&gt;</li>
</ul>
<h2 id="amp-和-nohup"><a href="#amp-和-nohup" class="headerlink" title="&amp; 和 nohup"></a>&amp; 和 nohup</h2><h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><p>总结常用数组的内容</p>
<h3 id="1-for-循环遍历数组"><a href="#1-for-循环遍历数组" class="headerlink" title="1. for 循环遍历数组"></a>1. for 循环遍历数组</h3><p>注意点：</p>
<ol>
<li>数组要单独定义，不能定义在 for 的 列表位置；</li>
</ol>
<p>举例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">a=(1 2 3)</span><br><span class="line"></span><br><span class="line">1. for .. in 的形式</span><br><span class="line">for i in $&#123;a[@]&#125;;do</span><br><span class="line">  echo $i</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">2. 可以带数组下标的 for...in</span><br><span class="line">for i in &quot;$&#123;!a[@]&#125;&quot;;do   </span><br><span class="line">    printf &quot;%s\t%s\n&quot; &quot;$i&quot; &quot;$&#123;a[$i]&#125;&quot;  </span><br><span class="line">done </span><br><span class="line"></span><br><span class="line">3. 标准 for 循环</span><br><span class="line">for(( i=0;i&lt;$&#123;#a[@]&#125;;i++ ));do</span><br><span class="line">  echo $&#123;a[i]&#125;</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="2-for-…-序列"><a href="#2-for-…-序列" class="headerlink" title="2. for … 序列"></a>2. for … 序列</h3><p>序列的形式可以直接写在 &lt;列表&gt; 的位置；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for i in &#123;22..30&#125;;do</span><br><span class="line">	echo $i;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>







<h1 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h1><p>-e 和 -E 作用的解释，不过-E还不懂，得测试一下才行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-e      Exit immediately if a pipeline (which may consist of a single simple command),  a subshell command enclosed  in  parentheses,  or  one  of the commands executed as part of a command list enclosed by braces (see SHELL GRAMMAR above) exits with a non-zero status.  The shell does not exit if the command that fails is part of the command list immediately following a while or until keyword, part of the test following the if or elif reserved words, part of any command executed in a &amp;&amp; or ││ list except the command following the final &amp;&amp; or ││, any command in a pipeline but the last, or  if  the command’s  return  value  is  being  inverted with !.  A trap on ERR, if set, is executed before the shell exits.  This option applies to the shell environment and each subshell environment separately  (see  COMMAND  EXECUTION  ENVIRONMENT above), and may cause subshells to exit before executing all the commands in the subshell.</span><br><span class="line"></span><br><span class="line">-E      If set, any trap on ERR is inherited by shell functions, command substitutions, and commands  executed  in  a  subshell environment.  The ERR trap is normally not inherited in such cases.</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="修改系统的sysctl-vm-swappiness-x3D-0值"><a href="#修改系统的sysctl-vm-swappiness-x3D-0值" class="headerlink" title="修改系统的sysctl vm.swappiness&#x3D;0值"></a>修改系统的sysctl vm.swappiness&#x3D;0值</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/vm/swappiness</span><br><span class="line">sysctl vm.swappiness=0</span><br><span class="line">each &quot;vm.swappiness=0&quot; &gt;&gt; /etc/sysctl.conf</span><br></pre></td></tr></table></figure>



<h1 id="理解Linux系统-x2F-etc-x2F-init-d目录和-x2F-etc-x2F-rc-local脚本"><a href="#理解Linux系统-x2F-etc-x2F-init-d目录和-x2F-etc-x2F-rc-local脚本" class="headerlink" title="理解Linux系统&#x2F;etc&#x2F;init.d目录和&#x2F;etc&#x2F;rc.local脚本"></a>理解Linux系统&#x2F;etc&#x2F;init.d目录和&#x2F;etc&#x2F;rc.local脚本</h1><ol>
<li><p>&#x2F;etc&#x2F;init.d 该目录下包含许多系统的各种服务的启动和停止脚本；</p>
<ul>
<li><p>用service命令可执行init.d目录中相应服务的脚本。</p>
</li>
<li><p>例如：&#x2F;etc&#x2F;init.d&#x2F;network restart 重启网络， service network restart</p>
</li>
</ul>
</li>
<li><p>&#x2F;etc&#x2F;rc#.d(其实是软链接文件，&#x2F;etc&#x2F;rc.d&#x2F;rc#.d，这里#代表一个指定的初始化级别，范围是0~6)，该文件下包含许多对进程进行控制的脚本。这些脚本放置的地方，将决定这些脚本什么时候开始运行。</p>
</li>
<li><p>&#x2F;etc&#x2F;rc.local(其实是软连接文件：&#x2F;etc&#x2F;rc.d&#x2F;rc.local)，该脚本是在系统初始化级别脚本运行之后执行的；</p>
<blockquote>
<p><strong>该脚本是在系统初始化级别的脚本运行之后再执行的</strong>，因此可以安全地在里面添加你想在系统启动之后执行的脚本。</p>
</blockquote>
</li>
</ol>
<h1 id="查看内存型号"><a href="#查看内存型号" class="headerlink" title="查看内存型号"></a>查看内存型号</h1><p>打开命令窗口Ctrl + Alt + T输入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dmidecode --type memory</span><br></pre></td></tr></table></figure>

<p>即可显示<strong>内存</strong>条的信息。</p>
<h1 id="开机自启"><a href="#开机自启" class="headerlink" title="开机自启"></a>开机自启</h1><p>centos7</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-unit-files  (查看开机启动项)</span><br><span class="line"></span><br><span class="line">systemctl list-unit-files  |  grep 程序名称   （查看某些服务开机启动状态）</span><br><span class="line"></span><br><span class="line">systemctl  list-unit-files |  grep enable （查看哪些为开机启动服务）</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>centos6</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ckconfig --list</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>版权声明： </strong>
          
          本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://ligongzhao.github.io/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Shell/" rel="tag">Shell</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/%E5%9C%A8CentOS7%E4%B8%8A%E5%AE%89%E8%A3%85ELK%E5%8D%95%E8%8A%82%E7%82%B9.html" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            在CentOS7上安装ELK单节点
          
        </div>
      </a>
    
    
      <a href="/Kali%E4%BD%BF%E7%94%A8.html" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">Kali使用</div>
      </a>
    
  </nav>

  
   
  
   
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2022
        <i class="ri-heart-fill heart_icon"></i> ligongzhao
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="听潮亭"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>